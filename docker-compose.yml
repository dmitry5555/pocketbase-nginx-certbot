
services:
  pocketbase:
    build:
      context: .
      dockerfile: pocketbase/Dockerfile
    volumes:
      - ./pocketbase:/pb/pb_data
    restart: unless-stopped
  nginx:
      build: .
      volumes:
        # - ./html:/usr/share/nginx/html
        - ./nginx.conf:/etc/nginx/nginx.conf
        - ./data/certbot/conf:/etc/letsencrypt
        - ./data/certbot/www:/var/www/certbot
      ports:
        - "80:80"
        - "443:443"
      restart: always
      networks:
        - nginx_network
  certbot:
      image: certbot/certbot
      volumes:
        - ./data/certbot/conf:/etc/letsencrypt
        - ./data/certbot/www:/var/www/certbot
      entrypoint: "/bin/sh -c 'trap exit TERM; while :; do certbot renew; sleep 12h & wait $${!}; done;'"
      networks:
        - nginx_network

  networks:
    nginx_network:
      driver: bridge